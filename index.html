<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì„€ë„ìš° ë§í¬ (Shadow Link)</title>
<style>
  body { text-align:center; font-family:Arial; background:#f0f0f0; }
  h1 { margin-top:20px; }
  #board { margin:20px auto; display:grid; grid-template-columns: repeat(8, 50px); grid-gap:2px; width:max-content; }
  .cell { width:50px; height:50px; background:#fff; border:1px solid #999; display:flex; align-items:center; justify-content:center; font-weight:bold; cursor:pointer; position:relative;}
  .token { width:40px; height:40px; border-radius:50%; }
  .highlight { outline:3px solid yellow; }
  #log { width:60%; height:120px; margin:20px auto; overflow-y:auto; border:1px solid #999; padding:10px; background:#fff; text-align:left;}
</style>
</head>
<body>
<h1>ì„€ë„ìš° ë§í¬ (Shadow Link)</h1>
<p>í† í° 3ê°œ ì§ì„  ì—°ê²° ì‹œ ìŠ¹ë¦¬í•©ë‹ˆë‹¤. í† í° í´ë¦­ í›„ ì´ë™í•  ì¹¸ì„ ì„ íƒí•˜ì„¸ìš”.</p>
<div id="board"></div>
<div id="log"></div>

<script>
const boardSize=8;
let board=[];
let currentPlayer=0;
let selectedToken=null;
const logBox=document.getElementById("log");

function log(message){ logBox.innerHTML+=message+"<br>"; logBox.scrollTop=logBox.scrollHeight; }

const boardDiv=document.getElementById("board");

// ë³´ë“œ ì´ˆê¸°í™” ë° ë Œë”ë§
function createBoard(){
  boardDiv.innerHTML="";
  board=[];
  for(let r=0;r<boardSize;r++){
    for(let c=0;c<boardSize;c++){
      const cell={row:r,col:c,owner:null,div:null};
      const div=document.createElement("div");
      div.className="cell";
      div.dataset.row=r;
      div.dataset.col=c;
      div.onclick=()=>cellClick(r,c);
      cell.div=div;
      board.push(cell);
      boardDiv.appendChild(div);
    }
  }
}
createBoard();

// ì´ˆê¸° í† í° ë°°ì¹˜
function placeInitialTokens(){
  board.forEach(cell=>{
    if(cell.row<2){ cell.owner=0; }
    else if(cell.row>=boardSize-2){ cell.owner=1; }
  });
  renderBoard();
}
placeInitialTokens();

// ë³´ë“œ ë Œë”ë§
function renderBoard(){
  board.forEach(c=>{
    const div=c.div;
    div.innerHTML="";
    div.classList.remove("highlight");
    if(c.owner!==null){
      const token=document.createElement("div");
      token.className="token";
      token.style.background=c.owner===0?"black":"white";
      div.appendChild(token);
    }
  });
  if(selectedToken) highlightMoves(selectedToken);
}

// í´ë¦­ ì²˜ë¦¬
function cellClick(row,col){
  const cell=board.find(c=>c.row===row && c.col===col);
  if(selectedToken){
    if(cell.div.classList.contains("highlight")){
      // ì´ë™
      cell.owner=currentPlayer;
      selectedToken.owner=null;
      log(`í”Œë ˆì´ì–´ ${currentPlayer+1} ì´ë™ ì™„ë£Œ`);
      selectedToken=null;
      renderBoard();
      if(checkWin(currentPlayer)){ log(`ğŸ‰ í”Œë ˆì´ì–´ ${currentPlayer+1} ìŠ¹ë¦¬!`); return; }
      currentPlayer=(currentPlayer+1)%2;
      log(`í„´ ë³€ê²½ â†’ í”Œë ˆì´ì–´ ${currentPlayer+1} ì°¨ë¡€`);
    } else { log("ìœ íš¨í•œ ì¹¸ì„ ì„ íƒí•˜ì„¸ìš”."); selectedToken=null; renderBoard(); }
  } else {
    if(cell.owner===currentPlayer){
      selectedToken=cell;
      renderBoard();
      log("í† í° ì„ íƒë¨");
    } else { log("ìì‹ ì˜ í† í°ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤."); }
  }
}

// ì´ë™ ê°€ëŠ¥ ì¹¸ í•˜ì´ë¼ì´íŠ¸
function highlightMoves(cell){
  const directions=[[-1,0],[1,0],[0,-1],[0,1]];
  directions.forEach(([dr,dc])=>{
    const nr=cell.row+dr, nc=cell.col+dc;
    if(nr>=0 && nr<boardSize && nc>=0 && nc<boardSize){
      const target=board.find(c=>c.row===nr && c.col===nc);
      if(target.owner===null) target.div.classList.add("highlight");
    }
  });
}

// ìŠ¹ë¦¬ ì²´í¬ (ê°€ë¡œ, ì„¸ë¡œ, ëŒ€ê°ì„ )
function checkWin(player){
  for(let r=0;r<boardSize;r++){
    for(let c=0;c<boardSize;c++){
      if(board.find(b=>b.row===r && b.col===c && b.owner===player)){
        if(checkLine(r,c,0,1,player)) return true; // ê°€ë¡œ
        if(checkLine(r,c,1,0,player)) return true; // ì„¸ë¡œ
        if(checkLine(r,c,1,1,player)) return true; // ëŒ€ê°ì„  ìš°í•˜
        if(checkLine(r,c,1,-1,player)) return true; // ëŒ€ê°ì„  ì¢Œí•˜
      }
    }
  }
  return false;
}

function checkLine(r,c,dr,dc,player){
  for(let i=1;i<3;i++){
    const nr=r+dr*i, nc=c+dc*i;
    if(nr<0||nr>=boardSize||nc<0||nc>=boardSize) return false;
    const cell=board.find(b=>b.row===nr && b.col===nc);
    if(!cell || cell.owner!==player) return false;
  }
  return true;
}

renderBoard();
log("ê²Œì„ ì‹œì‘! í”Œë ˆì´ì–´ 1 ì°¨ë¡€");
</script>
</body>
</html>
